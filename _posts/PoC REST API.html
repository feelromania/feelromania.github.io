<!DOCTYPE html>
<html>
<head>
    <title>PoC REST API</title>
    <meta charset="UTF-8">
    
</head>
<body>
<h1>PoC REST API</h1>
<div><h2 id="PoCRESTAPI-History">History</h2><ol><li>Metascan REST v1 introduced: mainly for MD4SA Cloud usage&#160;</li><li>Metascan REST v2 introduced: mainly for Metascan Online usage&#160;</li><li>Metascan REST v1 and v2 has been maintened for MD4SA Cloud&#160;and Metascan Online&#160;</li><li>Metascan/MO REST was <a class="createlink" href="/wiki/pages/createpage.action?spaceKey=MLD&amp;title=Should%20fork%20REST%20code%3F">forked</a> to go different direction&#160;</li><li>Metascan &#160;REST v1 and v2 exists both for Metascan Clients Usage</li></ol><p><br></p><h2 id="PoCRESTAPI-Future">Future</h2><ul><li>Duplicate implementation for potentially same interface but different details.&#160;</li><li>Whichever (MO REST or Metascan REST) introduce new API should be reviewed for both REST and delivered separately (implemented separately).&#160;</li><li>MUST try stay as compatible as possible between MO REST and Metascan REST from client perspective for customer to switch potentially between two.&#160;</li></ul><p><br></p><p><br></p><p>(Work in progress)</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col><col><col><col><col><col><col></colgroup><tbody><tr><th class="confluenceTh">Description</th><th colspan="1" class="confluenceTh">Central MGMT <br>requirement</th><th class="confluenceTh">V3 API</th><th class="confluenceTh">V4 API</th><th class="confluenceTh">Differences</th><th colspan="1" class="confluenceTh">Format of response</th><th colspan="1" class="confluenceTh">Verdict</th></tr><tr><td class="highlight-green confluenceTd" data-highlight-colour="green">Submitting a file</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><br></td><td class="highlight-green confluenceTd" data-highlight-colour="green">/file</td><td class="highlight-green confluenceTd" data-highlight-colour="green">/file</td><td class="highlight-green confluenceTd" data-highlight-colour="green">V4 api also has a header value for workflow selection. Guys in ground team already working on merging /process interface into /file</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Almost the same</td></tr><tr><td class="highlight-green confluenceTd" data-highlight-colour="green">Acquire scan status by data_id</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><br></td><td class="highlight-green confluenceTd" data-highlight-colour="green">/file/{data_id}</td><td class="highlight-green confluenceTd" data-highlight-colour="green">/file/{data_id}</td><td class="highlight-green confluenceTd" data-highlight-colour="green">Both sides can have additional information but the similar values have the same key so they are matching</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Almost the same</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Acquire scan status by hash</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><br></td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">/hash/{hash_value}</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">/hash/{hash_value}</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same like /file/{data_id}</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Almost the same</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Cleaning up scan history</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><br></td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/admin/logs/files/clear</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/admin/scanhistory/cleanup</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">In V3 this cleans all of the history, while in V4 a header value defines the interval to clean the history from.</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Different</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Has differences</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Get history of scanned files</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><br></td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/stat/threats/{count}</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/stat/log/scans</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">In V3 its only for the threats found, so no clean files appear, while in V4 all the submitted files will be in the history. By the way V3<br>has a lot other statistics interface to gather all the information.&#160;</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Different</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Has differences</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Get hourly statistics of scannings</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><br></td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/stat/scanhistory/{n_hour}</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/stat/scans</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Both use hourly resolution, but V3 does not hold latest threat.</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Different</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Has differences</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Upload update package</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><br></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">/admin/offlineupdate</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">/admin/update/upload</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Totally different as V3 and V4 uses different update packages. However V4 offline downloader will soon be able to create V3<br>acceptable packages.&#160;</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Enable or disable av engine</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><br></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><p>/admin/avs/exclude</p><p>/admin/avs/include</p></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><p><span style="color: rgb(0,0,0);">/admin/engine/{engine_id}/disable</span></p><p><span style="color: rgb(0,0,0);">/admin/engine/{engine_id}/enable</span></p></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">In V3 you have to specify engines inside request body, in V4 the url itself holds the engine identifier.</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Get license information</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><br></td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/admin/license</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">/admin/license</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Getting license info is very similar on both version</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Different</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Has differences</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Get events history happened to product</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><br></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">/admin/logs/events</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">/admin/audit/{system}</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Actually V3 offers something more like log created by the product , V4 is only holding events that are happened with the product</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Get update information</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><br></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">/admin/update</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red"><span style="color: rgb(0,0,0);">/admin/update/info</span></td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">As update mechanism is totally different the products gather different information on this API. V3 tracks if there is any<br>update in progress for any av, while V4 only tells information on the whole update process.&#160;</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">Different</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Get available engine information</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><br></td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">/stat/engines</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">/stat/engines</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Both sends back similar information, however V4 version is more verbose.</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Almost the same</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Get version information</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">V3 should provide the same /version interface, because with this information is easier to handle instances in the central management</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><p>/admin/prop/version</p><p>/version</p></td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">/version</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><p>V4 displays the "product_id"</p><p>as of Metascan 3.10, the V3 /version API also displays "product_id"</p><p>V3 /admin/prop/version still displays the version info in the old V3 style</p></td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Same</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">Almost the same</td></tr></tbody></table></div><p>*&#160;Information based on discussion with ground team.</p><p><br></p><p><br></p><h2 id="PoCRESTAPI-RESTAPItobediscussed">REST API to be discussed</h2><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="4da329c3-88e6-4cf9-802d-6868a67d3865"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body">use "restapi_tbd" label to mark API for discussion</div></div><p></p><div class="table-wrap conf-macro output-block" data-hasbody="false" data-macro-name="detailssummary" data-macro-id="0ab82376-dd18-46cc-ba9e-1589553d61c3"><table class="aui metadata-summary-macro restapi_tbd" data-cql='label = "restapi_tbd" and space = currentSpace ( )' data-first-column-heading="Title" data-count-comments="false" data-count-likes="false" data-total-pages="0" data-page-size="100" data-sort-by="null" data-reverse-sort="false" data-blueprint-present="false"><caption>Generating page properties report...</caption><thead> </thead><tbody> </tbody></table></div><p><br></p><div id="expander-1206303472" class="expand-container conf-macro output-block" data-hasbody="true" data-macro-name="expand" data-macro-id="cfb764cf-fc4f-4bb0-be21-64042c2b49d9"><div id="expander-control-1206303472" class="expand-control"><span class="expand-control-icon icon">&#160;</span><span class="expand-control-text">Supported By MO</span></div><div id="expander-content-1206303472" class="expand-content expand-hidden"><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="669890a1-2273-45f3-a0bd-9297256b9213"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>"restapi_mo" label should be added if supported by Metascan Online</p></div></div><p> </p><div class="table-wrap conf-macro output-block" data-hasbody="false" data-macro-name="detailssummary" data-macro-id="686f8b6f-34d9-497d-af9b-35da3a0f4342"><table class="aui metadata-summary-macro restapi_mo" data-cql='label = "restapi_mo" and space = currentSpace ( )' data-first-column-heading="Title" data-count-comments="false" data-count-likes="false" data-total-pages="0" data-page-size="100" data-sort-by="null" data-reverse-sort="false" data-blueprint-present="false"><caption>Generating page properties report...</caption><thead> </thead><tbody> </tbody></table></div><p> </p></div></div><div id="expander-986858709" class="expand-container conf-macro output-block" data-hasbody="true" data-macro-name="expand" data-macro-id="ce48aa2c-d7dd-493d-bd9c-7af7a5b77d51"><div id="expander-control-986858709" class="expand-control"><span class="expand-control-icon icon">&#160;</span><span class="expand-control-text">Supported by Metascan Windows</span></div><div id="expander-content-986858709" class="expand-content expand-hidden"><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="ac8fb3c3-e9ea-42ba-93de-0cb51432af62"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>"restapi_oms" label should be added if supported by Metascan Windows</p></div></div><p> </p><div class="table-wrap conf-macro output-block" data-hasbody="false" data-macro-name="detailssummary" data-macro-id="1fd0ec49-0127-40e4-b69e-44a0f6ebdae7"><table class="aui metadata-summary-macro restapi_oms" data-cql='label = "restapi_oms" and space = currentSpace ( )' data-first-column-heading="Title" data-count-comments="false" data-count-likes="false" data-total-pages="0" data-page-size="100" data-sort-by="null" data-reverse-sort="false" data-blueprint-present="false"><caption>Generating page properties report...</caption><thead> </thead><tbody> </tbody></table></div><p> </p><p><br></p></div></div><div id="expander-1818042441" class="expand-container conf-macro output-block" data-hasbody="true" data-macro-name="expand" data-macro-id="d8846d41-c592-4596-9d8a-873ebd712005"><div id="expander-control-1818042441" class="expand-control"><span class="expand-control-icon icon">&#160;</span><span class="expand-control-text">Supported by Metascan Linux</span></div><div id="expander-content-1818042441" class="expand-content expand-hidden"><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="c2bf48da-6c83-4fd8-9761-e382557784a8"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>"restapi_lms" label should be added if supported by Metascan Linux</p></div></div><p> </p><div class="table-wrap conf-macro output-block" data-hasbody="false" data-macro-name="detailssummary" data-macro-id="8b68866a-62e3-4447-8830-3ef83665aba2"><table class="aui metadata-summary-macro restapi_lms" data-cql='label = "restapi_lms" and space = currentSpace ( )' data-first-column-heading="Title" data-count-comments="false" data-count-likes="false" data-total-pages="0" data-page-size="100" data-sort-by="null" data-reverse-sort="false" data-blueprint-present="false"><caption>Generating page properties report...</caption><thead> </thead><tbody> </tbody></table></div><p> </p></div></div><div id="expander-58916590" class="expand-container conf-macro output-block" data-hasbody="true" data-macro-name="expand" data-macro-id="c34e205b-4ea6-427d-8b20-9b54b884e2d8"><div id="expander-control-58916590" class="expand-control"><span class="expand-control-icon icon">&#160;</span><span class="expand-control-text">Used by GEARS</span></div><div id="expander-content-58916590" class="expand-content expand-hidden"><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="7a41058b-2e46-4b00-b64d-11a3c1564ee1"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>"used_by_gears" label should be added if used by GEARS team so that we can be double careful with backward compatibility</p></div></div><p> </p><div class="table-wrap conf-macro output-block" data-hasbody="false" data-macro-name="detailssummary" data-macro-id="6897bb5e-cc22-4bb7-8521-07d0c1483c3c"><table class="aui metadata-summary-macro restapi_lms" data-cql='label = "used_by_gears" and space = currentSpace ( )' data-first-column-heading="Title" data-count-comments="false" data-count-likes="false" data-total-pages="0" data-page-size="100" data-sort-by="null" data-reverse-sort="false" data-blueprint-present="false"><caption>Generating page properties report...</caption><thead> </thead><tbody> </tbody></table></div><p> </p></div></div><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info" data-macro-id="71545362-ee9b-4d01-af13-0b4f9e49aff6"><p class="title">NOTE</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>All timestamps returned by REST V2 APIs will be in UTC and it will be up to whoever uses the API to convert to local time if needed.</p></div></div></div>

<h2>Attachments</h2>
</body>
</html>